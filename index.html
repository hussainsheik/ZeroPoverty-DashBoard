<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Futuristic Mandal Data Dashboard</title>
    <style>
        :root {
            --primary: #00f7ff;
            --secondary: #0066ff;
            --dark: #0a0a1a;
            --light: #e0f8ff;
            --accent: #ff00aa;
            --grid-color: rgba(0, 247, 255, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--dark);
            color: var(--light);
            min-height: 100vh;
            background-image: 
                linear-gradient(var(--grid-color) 1px, transparent 1px),
                linear-gradient(90deg, var(--grid-color) 1px, transparent 1px);
            background-size: 50px 50px;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid var(--primary);
            margin-bottom: 30px;
            position: relative;
        }

        header::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 100%;
            height: 1px;
            background: var(--primary);
            filter: blur(5px);
        }

        h1 {
            font-size: 2.5rem;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-transform: uppercase;
            letter-spacing: 2px;
            position: relative;
        }

        h1::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 0;
            width: 50%;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), transparent);
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-size: 1.5rem;
            color: var(--primary);
        }

        .loading::after {
            content: '⠋';
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            0% { content: '⠋'; }
            14% { content: '⠙'; }
            28% { content: '⠹'; }
            42% { content: '⠸'; }
            57% { content: '⠼'; }
            71% { content: '⠴'; }
            85% { content: '⠦'; }
            100% { content: '⠧'; }
        }

        .filters {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .filter-group {
            flex: 1;
            min-width: 250px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: var(--primary);
            font-weight: 500;
        }

        select {
            width: 100%;
            padding: 12px;
            background-color: rgba(0, 0, 0, 0.5);
            border: 1px solid var(--primary);
            color: var(--light);
            border-radius: 4px;
            font-size: 1rem;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%2300f7ff'%3e%3cpath d='M7 10l5 5 5-5z'/%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 20px;
            transition: all 0.3s ease;
        }

        select:focus {
            outline: none;
            box-shadow: 0 0 0 2px var(--primary);
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }

        .card {
            background: rgba(10, 10, 26, 0.8);
            border: 1px solid var(--primary);
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 247, 255, 0.1);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, var(--primary), var(--secondary), var(--accent));
            z-index: -1;
            border-radius: 10px;
            opacity: 0.3;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 247, 255, 0.2);
        }

        .card h2 {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: var(--primary);
            display: flex;
            align-items: center;
        }

        .card h2::before {
            content: '';
            display: inline-block;
            width: 10px;
            height: 10px;
            background-color: var(--primary);
            margin-right: 10px;
            border-radius: 50%;
            box-shadow: 0 0 10px var(--primary);
        }

        .chart-container {
            width: 100%;
            height: 250px;
            position: relative;
        }

        .data-grid {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        .data-grid th, .data-grid td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(0, 247, 255, 0.2);
        }

        .data-grid th {
            color: var(--primary);
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.8rem;
            letter-spacing: 1px;
        }

        .data-grid tr:hover td {
            background-color: rgba(0, 247, 255, 0.05);
        }

        .map-container {
            width: 100%;
            height: 400px;
            background-color: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--primary);
            border-radius: 8px;
            overflow: hidden;
            position: relative;
            grid-column: 1 / -1;
        }

        .map-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--primary);
            font-size: 1.2rem;
        }

        .stat-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 15px;
        }

        .stat-item {
            background: rgba(0, 103, 255, 0.1);
            border-left: 3px solid var(--secondary);
            padding: 15px;
            border-radius: 4px;
        }

        .stat-item h3 {
            font-size: 0.9rem;
            color: var(--light);
            margin-bottom: 5px;
            font-weight: 500;
        }

        .stat-item p {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            margin: 0;
        }

        .comparison-chart {
            grid-column: 1 / -1;
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 0.6; }
            50% { opacity: 1; }
            100% { opacity: 0.6; }
        }

        .glow {
            text-shadow: 0 0 10px var(--primary);
        }

        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .filters {
                flex-direction: column;
            }
            
            .stat-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="loading" id="loading">Loading Mandal Data</div>

    <div class="container" id="app" style="display: none;">
        <header>
            <h1>Mandal <span class="glow">Secretariat</span> Dashboard</h1>
            <div id="last-updated" class="pulse"></div>
        </header>

        <div class="filters">
            <div class="filter-group">
                <label for="mandal-filter">Select Mandal</label>
                <select id="mandal-filter">
                    <option value="all">All Mandals</option>
                </select>
            </div>
            <div class="filter-group">
                <label for="secretariat-filter">Select Secretariat</label>
                <select id="secretariat-filter">
                    <option value="all">All Secretariats</option>
                </select>
            </div>
        </div>

        <div class="map-container">
            <div class="map-placeholder">
                Geographical Map Visualization (Implementation depends on mapping service)
            </div>
        </div>

        <div class="dashboard">
            <div class="card">
                <h2>Summary Statistics</h2>
                <div class="stat-grid" id="summary-stats">
                    <!-- Filled by JavaScript -->
                </div>
            </div>

            <div class="card">
                <h2>Families Overview</h2>
                <div class="chart-container">
                    <canvas id="families-chart"></canvas>
                </div>
            </div>

            <div class="card">
                <h2>Adoption Progress</h2>
                <div class="chart-container">
                    <canvas id="adoption-chart"></canvas>
                </div>
            </div>

            <div class="card comparison-chart">
                <h2>Mandal Comparison</h2>
                <div class="chart-container" style="height: 350px;">
                    <canvas id="comparison-chart"></canvas>
                </div>
            </div>

            <div class="card" style="grid-column: 1 / -1;">
                <h2>Detailed Data</h2>
                <div style="overflow-x: auto;">
                    <table class="data-grid" id="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Mandal</th>
                                <th>Secretariat</th>
                                <th>Total Families</th>
                                <th>Family Members</th>
                                <th>Adopted</th>
                                <th>Yet to Adopt</th>
                                <th>Mobilized</th>
                                <th>Total Secretariats</th>
                                <th>Covered</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Filled by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Google Sheets URL and sheet names
        const SHEET_URL = 'https://docs.google.com/spreadsheets/d/14iegStGgs20yLRkPDpds1oms8aLhuSOFxm1aE-d7tEE/gviz/tq?';
        const SECRETARIAT_SHEET = 'SecretariatData';
        const MANDAL_SHEET = 'Mandal';
        
        // Cache for storing fetched data
        let allData = [];
        let mandalData = [];
        let filteredData = [];
        
        // Chart instances
        let familiesChart;
        let adoptionChart;
        let comparisonChart;
        
        // DOM elements
        const loadingElement = document.getElementById('loading');
        const appElement = document.getElementById('app');
        const mandalFilter = document.getElementById('mandal-filter');
        const secretariatFilter = document.getElementById('secretariat-filter');
        const summaryStatsElement = document.getElementById('summary-stats');
        const dataTableBody = document.querySelector('#data-table tbody');
        const lastUpdatedElement = document.getElementById('last-updated');
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                // Fetch data from Google Sheets
                await fetchData();
                
                // Initialize filters
                initializeFilters();
                
                // Render initial data
                filterData();
                
                // Hide loading and show app
                loadingElement.style.display = 'none';
                appElement.style.display = 'block';
                
                // Update last updated time
                lastUpdatedElement.textContent = `Last updated: ${new Date().toLocaleString()}`;
            } catch (error) {
                console.error('Error initializing app:', error);
                loadingElement.textContent = 'Error loading data. Please try again.';
            }
        });
        
        // Fetch data from Google Sheets
        async function fetchData() {
            try {
                // Fetch SecretariatData
                const secretariatUrl = `${SHEET_URL}&sheet=${SECRETARIAT_SHEET}`;
                const secretariatResponse = await fetch(secretariatUrl);
                const secretariatText = await secretariatResponse.text();
                const secretariatJson = JSON.parse(secretariatText.substring(47).slice(0, -2));
                
                allData = processSheetData(secretariatJson);
                
                // Fetch Mandal data
                const mandalUrl = `${SHEET_URL}&sheet=${MANDAL_SHEET}`;
                const mandalResponse = await fetch(mandalUrl);
                const mandalText = await mandalResponse.text();
                const mandalJson = JSON.parse(mandalText.substring(47).slice(0, -2));
                
                mandalData = processSheetData(mandalJson);
                
                // Merge Mandal names into Secretariat data
                allData = allData.map(item => {
                    const mandal = mandalData.find(m => m.ID === item.ID);
                    return {
                        ...item,
                        MandalName: mandal ? mandal.MandalName : 'Unknown'
                    };
                });
                
            } catch (error) {
                console.error('Error fetching data:', error);
                throw error;
            }
        }
        
        // Process Google Sheets data into usable format
        function processSheetData(jsonData) {
            const rows = jsonData.table.rows;
            const headers = rows[0].c.map(header => header.v);
            
            return rows.slice(1).map(row => {
                const obj = {};
                row.c.forEach((cell, index) => {
                    obj[headers[index]] = cell ? cell.v : null;
                });
                return obj;
            });
        }
        
        // Initialize dropdown filters
        function initializeFilters() {
            // Get unique Mandals
            const mandals = [...new Set(allData.map(item => item.MandalName))].filter(Boolean);
            mandals.sort();
            
            mandals.forEach(mandal => {
                const option = document.createElement('option');
                option.value = mandal;
                option.textContent = mandal;
                mandalFilter.appendChild(option);
            });
            
            // Get unique Secretariats
            const secretariats = [...new Set(allData.map(item => item.SecretariatName))].filter(Boolean);
            secretariats.sort();
            
            secretariats.forEach(secretariat => {
                const option = document.createElement('option');
                option.value = secretariat;
                option.textContent = secretariat;
                secretariatFilter.appendChild(option);
            });
            
            // Add event listeners
            mandalFilter.addEventListener('change', filterData);
            secretariatFilter.addEventListener('change', filterData);
        }
        
        // Filter data based on selections
        function filterData() {
            const selectedMandal = mandalFilter.value;
            const selectedSecretariat = secretariatFilter.value;
            
            filteredData = allData.filter(item => {
                const mandalMatch = selectedMandal === 'all' || item.MandalName === selectedMandal;
                const secretariatMatch = selectedSecretariat === 'all' || item.SecretariatName === selectedSecretariat;
                return mandalMatch && secretariatMatch;
            });
            
            // Update UI with filtered data
            updateSummaryStats();
            updateDataTable();
            updateCharts();
        }
        
        // Update summary statistics
        function updateSummaryStats() {
            if (filteredData.length === 0) {
                summaryStatsElement.innerHTML = '<p>No data available for selected filters</p>';
                return;
            }
            
            const totals = {
                families: 0,
                members: 0,
                adopted: 0,
                yetToAdopt: 0,
                mobilized: 0,
                secretariats: 0,
                covered: 0
            };
            
            filteredData.forEach(item => {
                totals.families += item.TotalFamilies || 0;
                totals.members += item.TotalFamilyMembers || 0;
                totals.adopted += item.TotalAdopted || 0;
                totals.yetToAdopt += item.TotalBangaruKutumbamYetToAdopt || 0;
                totals.mobilized += item.TotalMargadarsiMobilized || 0;
                totals.secretariats += item.TotalSecretariats || 0;
                totals.covered += item.CoveredSecretariats || 0;
            });
            
            const coveragePercentage = totals.secretariats > 0 
                ? Math.round((totals.covered / totals.secretariats) * 100) 
                : 0;
            
            summaryStatsElement.innerHTML = `
                <div class="stat-item">
                    <h3>Total Families</h3>
                    <p>${totals.families.toLocaleString()}</p>
                </div>
                <div class="stat-item">
                    <h3>Family Members</h3>
                    <p>${totals.members.toLocaleString()}</p>
                </div>
                <div class="stat-item">
                    <h3>Adopted Families</h3>
                    <p>${totals.adopted.toLocaleString()}</p>
                </div>
                <div class="stat-item">
                    <h3>Yet to Adopt</h3>
                    <p>${totals.yetToAdopt.toLocaleString()}</p>
                </div>
                <div class="stat-item">
                    <h3>Mobilized</h3>
                    <p>${totals.mobilized.toLocaleString()}</p>
                </div>
                <div class="stat-item">
                    <h3>Coverage</h3>
                    <p>${coveragePercentage}%</p>
                </div>
            `;
        }
        
        // Update data table
        function updateDataTable() {
            dataTableBody.innerHTML = '';
            
            if (filteredData.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = '<td colspan="10" style="text-align: center;">No data available for selected filters</td>';
                dataTableBody.appendChild(row);
                return;
            }
            
            filteredData.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${item.ID || ''}</td>
                    <td>${item.MandalName || ''}</td>
                    <td>${item.SecretariatName || ''}</td>
                    <td>${item.TotalFamilies || 0}</td>
                    <td>${item.TotalFamilyMembers || 0}</td>
                    <td>${item.TotalAdopted || 0}</td>
                    <td>${item.TotalBangaruKutumbamYetToAdopt || 0}</td>
                    <td>${item.TotalMargadarsiMobilized || 0}</td>
                    <td>${item.TotalSecretariats || 0}</td>
                    <td>${item.CoveredSecretariats || 0}</td>
                `;
                dataTableBody.appendChild(row);
            });
        }
        
        // Update all charts
        function updateCharts() {
            updateFamiliesChart();
            updateAdoptionChart();
            updateComparisonChart();
        }
        
        // Create/update families chart
        function updateFamiliesChart() {
            const ctx = document.getElementById('families-chart').getContext('2d');
            
            if (filteredData.length === 0) {
                if (familiesChart) familiesChart.destroy();
                return;
            }
            
            const labels = filteredData.map(item => item.SecretariatName || `Secretariat ${item.ID}`);
            const familiesData = filteredData.map(item => item.TotalFamilies || 0);
            const membersData = filteredData.map(item => item.TotalFamilyMembers || 0);
            
            if (familiesChart) {
                familiesChart.data.labels = labels;
                familiesChart.data.datasets[0].data = familiesData;
                familiesChart.data.datasets[1].data = membersData;
                familiesChart.update();
                return;
            }
            
            familiesChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Total Families',
                            data: familiesData,
                            backgroundColor: 'rgba(0, 247, 255, 0.7)',
                            borderColor: 'rgba(0, 247, 255, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'Family Members',
                            data: membersData,
                            backgroundColor: 'rgba(0, 103, 255, 0.7)',
                            borderColor: 'rgba(0, 103, 255, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0, 247, 255, 0.1)'
                            },
                            ticks: {
                                color: 'rgba(224, 248, 255, 0.7)'
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(0, 247, 255, 0.1)'
                            },
                            ticks: {
                                color: 'rgba(224, 248, 255, 0.7)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: 'rgba(224, 248, 255, 0.7)'
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false
                        }
                    },
                    animation: {
                        duration: 1000
                    }
                }
            });
        }
        
        // Create/update adoption chart
        function updateAdoptionChart() {
            const ctx = document.getElementById('adoption-chart').getContext('2d');
            
            if (filteredData.length === 0) {
                if (adoptionChart) adoptionChart.destroy();
                return;
            }
            
            const labels = filteredData.map(item => item.SecretariatName || `Secretariat ${item.ID}`);
            const adoptedData = filteredData.map(item => item.TotalAdopted || 0);
            const yetToAdoptData = filteredData.map(item => item.TotalBangaruKutumbamYetToAdopt || 0);
            
            if (adoptionChart) {
                adoptionChart.data.labels = labels;
                adoptionChart.data.datasets[0].data = adoptedData;
                adoptionChart.data.datasets[1].data = yetToAdoptData;
                adoptionChart.update();
                return;
            }
            
            adoptionChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Adopted',
                            data: adoptedData,
                            backgroundColor: filteredData.map(() => 
                                `hsl(${Math.random() * 360}, 70%, 50%)`
                            ),
                            borderColor: 'rgba(10, 10, 26, 0.8)',
                            borderWidth: 2
                        },
                        {
                            label: 'Yet to Adopt',
                            data: yetToAdoptData,
                            backgroundColor: filteredData.map(() => 
                                `hsla(${Math.random() * 360}, 70%, 30%, 0.7)`
                            ),
                            borderColor: 'rgba(10, 10, 26, 0.8)',
                            borderWidth: 2
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                color: 'rgba(224, 248, 255, 0.7)'
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.dataset.label || '';
                                    const value = context.raw || 0;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = Math.round((value / total) * 100);
                                    return `${label}: ${value} (${percentage}%)`;
                                }
                            }
                        }
                    },
                    animation: {
                        animateScale: true,
                        animateRotate: true
                    }
                }
            });
        }
        
        // Create/update comparison chart
        function updateComparisonChart() {
            const ctx = document.getElementById('comparison-chart').getContext('2d');
            
            // Group data by Mandal if "All Mandals" is selected
            let comparisonData;
            let comparisonLabels;
            
            if (mandalFilter.value === 'all') {
                // Group by Mandal
                const mandalGroups = {};
                
                allData.forEach(item => {
                    if (!mandalGroups[item.MandalName]) {
                        mandalGroups[item.MandalName] = {
                            families: 0,
                            members: 0,
                            adopted: 0,
                            yetToAdopt: 0,
                            mobilized: 0,
                            secretariats: 0,
                            covered: 0
                        };
                    }
                    
                    mandalGroups[item.MandalName].families += item.TotalFamilies || 0;
                    mandalGroups[item.MandalName].members += item.TotalFamilyMembers || 0;
                    mandalGroups[item.MandalName].adopted += item.TotalAdopted || 0;
                    mandalGroups[item.MandalName].yetToAdopt += item.TotalBangaruKutumbamYetToAdopt || 0;
                    mandalGroups[item.MandalName].mobilized += item.TotalMargadarsiMobilized || 0;
                    mandalGroups[item.MandalName].secretariats += item.TotalSecretariats || 0;
                    mandalGroups[item.MandalName].covered += item.CoveredSecretariats || 0;
                });
                
                comparisonLabels = Object.keys(mandalGroups);
                comparisonData = [
                    {
                        label: 'Families',
                        data: comparisonLabels.map(mandal => mandalGroups[mandal].families),
                        borderColor: 'rgba(0, 247, 255, 1)',
                        backgroundColor: 'rgba(0, 247, 255, 0.2)',
                        borderWidth: 2
                    },
                    {
                        label: 'Adopted',
                        data: comparisonLabels.map(mandal => mandalGroups[mandal].adopted),
                        borderColor: 'rgba(0, 255, 100, 1)',
                        backgroundColor: 'rgba(0, 255, 100, 0.2)',
                        borderWidth: 2
                    },
                    {
                        label: 'Yet to Adopt',
                        data: comparisonLabels.map(mandal => mandalGroups[mandal].yetToAdopt),
                        borderColor: 'rgba(255, 100, 0, 1)',
                        backgroundColor: 'rgba(255, 100, 0, 0.2)',
                        borderWidth: 2
                    }
                ];
            } else {
                // Show all secretariats in the selected mandal
                comparisonLabels = filteredData.map(item => item.SecretariatName || `Secretariat ${item.ID}`);
                comparisonData = [
                    {
                        label: 'Families',
                        data: filteredData.map(item => item.TotalFamilies || 0),
                        borderColor: 'rgba(0, 247, 255, 1)',
                        backgroundColor: 'rgba(0, 247, 255, 0.2)',
                        borderWidth: 2
                    },
                    {
                        label: 'Adopted',
                        data: filteredData.map(item => item.TotalAdopted || 0),
                        borderColor: 'rgba(0, 255, 100, 1)',
                        backgroundColor: 'rgba(0, 255, 100, 0.2)',
                        borderWidth: 2
                    },
                    {
                        label: 'Yet to Adopt',
                        data: filteredData.map(item => item.TotalBangaruKutumbamYetToAdopt || 0),
                        borderColor: 'rgba(255, 100, 0, 1)',
                        backgroundColor: 'rgba(255, 100, 0, 0.2)',
                        borderWidth: 2
                    }
                ];
            }
            
            if (comparisonChart) {
                comparisonChart.data.labels = comparisonLabels;
                comparisonChart.data.datasets = comparisonData;
                comparisonChart.update();
                return;
            }
            
            comparisonChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: comparisonLabels,
                    datasets: comparisonData
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: {
                                color: 'rgba(0, 247, 255, 0.2)'
                            },
                            grid: {
                                color: 'rgba(0, 247, 255, 0.2)'
                            },
                            pointLabels: {
                                color: 'rgba(224, 248, 255, 0.7)'
                            },
                            ticks: {
                                backdropColor: 'rgba(10, 10, 26, 0.8)',
                                color: 'rgba(224, 248, 255, 0.7)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: 'rgba(224, 248, 255, 0.7)'
                            }
                        }
                    },
                    elements: {
                        line: {
                            tension: 0.1
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>
